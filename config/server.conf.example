# SSH Jump Server v2 配置文件
# 复制到 /etc/ssh_jump/config.conf 使用

[ssh]
# SSH 服务器监听地址
listen_address = 0.0.0.0

# SSH 服务器端口 (用户连接端口)
port = 2222

# 主机密钥路径 (用于 SSH 服务器身份)
host_key_path = /etc/ssh_jump/host_key

# 支持的认证方法: publickey, password (推荐使用 publickey)
auth_methods = publickey

# 是否允许 root 登录
permit_root_login = no

# 最大认证尝试次数
max_auth_tries = 3

# 空闲超时时间 (秒)
idle_timeout = 300

[cluster]
# Agent 集群监听地址
listen_address = 0.0.0.0

# Agent 集群端口 (内网机器注册端口)
port = 8888

# Agent token 配置文件路径
agent_token_file = /etc/ssh_jump/agent_tokens.conf

# 心跳检查间隔 (秒)
heartbeat_interval = 30

# 心跳超时时间 (秒)
heartbeat_timeout = 90

[assets]
# 资产刷新间隔 (秒)
refresh_interval = 30

# 用户权限配置文件
permissions_file = /etc/ssh_jump/user_permissions.conf

[logging]
# 日志级别: debug, info, warn, error
level = info

# 日志文件路径
log_file = /var/log/ssh_jump/server.log

# 审计日志路径
audit_log = /var/log/ssh_jump/audit.log

# 是否启用会话录制
session_recording = true

# 会话录制文件保存路径
session_path = /var/log/ssh_jump/sessions/

[security]
# 是否启用命令审计
command_audit = true

# 允许的 SSH 命令 (为空表示允许所有)
allowed_commands =

# 禁止的 SSH 命令
forbidden_commands = rm -rf, mkfs, fdisk

# 是否允许端口转发
allow_port_forwarding = false

# 是否允许 SCP/SFTP
allow_sftp = false

# 每个来源 IP 每分钟允许的新连接数（防暴力探测/连接洪泛）
max_connections_per_minute = 10

[management]
# 子节点配置文件（公网管理节点的下级节点清单）
child_nodes_file = /etc/ssh_jump/child_nodes.conf
